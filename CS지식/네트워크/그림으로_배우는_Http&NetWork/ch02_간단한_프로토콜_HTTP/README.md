# 2. 간단한 프로토콜 HTTP

- HTTP `프로토콜 구조`에 대해 설명

## 목차

- [2. 간단한 프로토콜 HTTP](#2-%EA%B0%84%EB%8B%A8%ED%95%9C-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-http)
  - [2.1 HTTP는 클라이언트와 서버 간에 통신을 함](#21-http%EB%8A%94-%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%EC%99%80-%EC%84%9C%EB%B2%84-%EA%B0%84%EC%97%90-%ED%86%B5%EC%8B%A0%EC%9D%84-%ED%95%A8)
  - [2.2 리퀘스트와 리스폰스를 교환하여 성립](#22-%EB%A6%AC%ED%80%98%EC%8A%A4%ED%8A%B8%EC%99%80-%EB%A6%AC%EC%8A%A4%ED%8F%B0%EC%8A%A4%EB%A5%BC-%EA%B5%90%ED%99%98%ED%95%98%EC%97%AC-%EC%84%B1%EB%A6%BD)
  - [2.3 HTTP는 상태를 유지하지 않는 프로토콜](#23-http%EB%8A%94-%EC%83%81%ED%83%9C%EB%A5%BC-%EC%9C%A0%EC%A7%80%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C)
  - [2.4 리퀘스트 URI로 리소스를 식별](#24-%EB%A6%AC%ED%80%98%EC%8A%A4%ED%8A%B8-uri%EB%A1%9C-%EB%A6%AC%EC%86%8C%EC%8A%A4%EB%A5%BC-%EC%8B%9D%EB%B3%84)
  - [2.5 서버에 임무를 부여하는 HTTP 메소드](#25-%EC%84%9C%EB%B2%84%EC%97%90-%EC%9E%84%EB%AC%B4%EB%A5%BC-%EB%B6%80%EC%97%AC%ED%95%98%EB%8A%94-http-%EB%A9%94%EC%86%8C%EB%93%9C)
    - [GET: 리소스 획득](#get-%EB%A6%AC%EC%86%8C%EC%8A%A4-%ED%9A%8D%EB%93%9D)
    - [POST: 엔티티 전송](#post-%EC%97%94%ED%8B%B0%ED%8B%B0-%EC%A0%84%EC%86%A1)
    - [PUT: 파일 전송](#put-%ED%8C%8C%EC%9D%BC-%EC%A0%84%EC%86%A1)
    - [HEAD: 메시지 헤더 취득](#head-%EB%A9%94%EC%8B%9C%EC%A7%80-%ED%97%A4%EB%8D%94-%EC%B7%A8%EB%93%9D)
    - [DELETE: 파일 삭제](#delete-%ED%8C%8C%EC%9D%BC-%EC%82%AD%EC%A0%9C)
    - [OPTIONS: 제공하고 잇는 메소드의 문의](#options-%EC%A0%9C%EA%B3%B5%ED%95%98%EA%B3%A0-%EC%9E%87%EB%8A%94-%EB%A9%94%EC%86%8C%EB%93%9C%EC%9D%98-%EB%AC%B8%EC%9D%98)
    - [TRACE: 경로 조사](#trace-%EA%B2%BD%EB%A1%9C-%EC%A1%B0%EC%82%AC)
    - [CONNECT: 프록시에 터널링 요구](#connect-%ED%94%84%EB%A1%9D%EC%8B%9C%EC%97%90-%ED%84%B0%EB%84%90%EB%A7%81-%EC%9A%94%EA%B5%AC)
  - [2.6 메소드를 사용해서 지시를 내리다](#26-%EB%A9%94%EC%86%8C%EB%93%9C%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%84%9C-%EC%A7%80%EC%8B%9C%EB%A5%BC-%EB%82%B4%EB%A6%AC%EB%8B%A4)

## 2.1 HTTP는 클라이언트와 서버 간에 통신을 함

- TCP/IP에 있는 다른 많은 프로토콜과 마찬가지로
- ┣ `HTTP도 클라언트/서버간 통신`을 함
- ┣ `클라이언트` : `텍스트와 이미지 등과 같은 리소스` 필요
- ┗ `서버` : `리소스 제공`

- `HTTP를 사용`하여 2대의 컴퓨터 간에 `통신`을 하는 경우
- ┣ 한 번 통신을 할 때 마다 `어느쪽은 반드시 클라이언트/서버`
- ┗ `HTTP`는 `클라이언트와 서버를 명확하게 구별`

## 2.2 리퀘스트와 리스폰스를 교환하여 성립

- `HTTP` : `클라이언트`로부터 `리퀘스트(요청, Request) 송신`
- ┣ `결과`가 `서버`로부터 `리스폰스(응답, Response)`
- ┣ 즉 : 무조건 클라이언트 부터 통신이 시작
- ┗ 서버 : request 없이 response 안줌

> client → HTTP server

    GET / index.html HTTP /1.1
    Host: www.google.com

- `GET`: 서버에서 요구하는 종류 → `메소드`라고 불림
- ┣ 문자열 `/index.html` : 요구 대상인 리소스를 나타냄
- ┣ `리퀘스트 URI`라고 함
- ┣ `HTTP/1.1`는 클라이언트 기능을 식별하기 위한
- ┗ `HTTP 버전 번호`

- 리퀘스트 내용은 HTTP 서버 상에 있는 `/index.html`라는 리소스 필요
- ┣ 리퀘스트임
- ┣ 리퀘스트 메시지 : 1. `메소드`, 2. `URI`, 3. `프로토콜 버전`,
- ┣ 4. `옵션 리퀘스트 헤더필드`, 5. `엔티티`
- ┣ `POST / form/entry HTTP/1.1`

1. `POST` : 메소드
2. `form/entry HTTP` : URI
3. `HTTP/1.1` : 프로토콜 버전
4. 리퀘스트 헤더 필드

```json
Host: google.com
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 16
```

5. 엔티티 : `name=ueno&age=37`

- 리퀘스트를 받은 서버는 response를 클라이언트에 되돌려줌

```json
HTTP /1.1 200 OK
Date: Tue, 10, Jul 2022 06:50:15 GMT
Content-Length: 362
Content-Type: text/html

<html>
```

- 첫 번째 줄 `HTTP /1.1` : 서버의 HTTP 버전
- ┣ `200 OK` : request 처리 결과를 나타내는 상태 코드와 설명
- ┣ 2 번째 줄 : `response가 발생할 일시` (`헤더 필드` 중 하나)
- ┗ 다음은 공백으로 분리 : `바디(body) 본체`

- 기본적으로 `리스폰스 메시지` : 1. `프로토콜 버전`, 2. `상태 코드(성/실)`
- ┗ 3. `상태 코드`를 설명한 `프레이즈`, 4. 옵션의 `리스폰스 헤더 필드`와 `바디`로 구성

## 2.3 HTTP는 상태를 유지하지 않는 프로토콜

- `HTTP` : 상태를 계속 유지하지 않는 `스테이트리스(stateless) 프로토콜`
- ┣ HTTP 프로토콜 독자적으로 리퀘스트와 리스폰스를 교환하는 상태 관리 X
- ┣ 결국 HTTP 프로토콜 레벨에는 이전에 보냈던 리퀘스트나
- ┗ 이미 되돌려준 리스폰스에 대해서는 `전혀 기억 X`

- `새로운 request` → `새로운 response`
- ┣ 이는 많은 데이터를 `빠르고, 확실하게 처리`하는
- ┗ `범위성(scalability)`을 확보하기 위함

- 그러나 `웹의 진화`로 스테이트리스 특성만으로는
- ┣ 처리하기 어려운 일들이 증가
- ┣ ex : 쇼핑사이트 로그인
- ┣ `로그인 상태의 유지가 필요`
- ┣ `HTTP/1.1` : 상태를 유지하지 않는 프토콜
- ┗ 이를 해결하기 위한 `쿠키 등장`

## 2.4 리퀘스트 URI로 리소스를 식별

- `HTTP : URI(Uniform Resource Identifiers)`를 사용하여
- ┣ `인터넷 상의 리소스를 지정`
- ┣ 이 URI가 있는 덕분에 인터넷 상의 어떤 장소에 있는
- ┗ 리소스도 `호출 가능`

- client는 리소스를 호출할 때마다 `request 송신`할 때에 필요한
- ┣ `URI`를 `request URI`라고 불리는 형식으로 포함해야 할 필요가 있음
- ┗ 리퀘스트 URI를 지정하는 방법에는 여러 종류가 존재

- 모든 URI를 리퀘스트 URI에 포함

> GET https://google.com

- Host 헤더 필드에 네트워크 로케이션을 포함

> GET /index.html HTTP/1.1
> Host: google.com

- 특정 리소스가 아닌 `서버 자신에게 리퀘스틀 송신`하는 경우
- ┣ 리퀘스트 URI에 `[*]`지정 가능
- ┣ 아래는 HTTP 서버가 지원하고 있는
- ┗ 메소드를 묻는 예

```json
OPTIONS * HTTP/1.1
```

## 2.5 서버에 임무를 부여하는 HTTP 메소드

- 이제 HTTP/1.1에서 사용할 수 있는 메소드 설명

### GET: 리소스 획득

- `GET 메소드` : `리퀘스트 URI`로 `식별된 리소스를 가져올 수 있도록 요구`
- ┣ 가져올 리소스 내용은 지정된 `리소스를 서버가 해석한 결과`
- ┗ `텍스트` : `그대로` 반환, `GGI` 같은 프로그램 : `실행해서 출력`해서 돌려줌

### POST: 엔티티 전송

- POST 메소드는 엔티티를 전송하기 위해서 사용
- ┣ GET 메소드를 이용해 엔티티 전송 가능 하지만
- ┣ 자주 사용하지는 않음
- ┗ 엔티티를 획득하는 것만이 목적은 아님

### PUT: 파일 전송

- `PUT 메소드`는 `파일을 전송하기 위해서 사용`
- ┣ `FTP에 의한 파일 업로드`와 같이
- ┣ 리퀘스트 중에서 `엔티티를 리퀘스트 URI 지정한 곳`에서
- ┗ `보존하도록 요구`

- 단지 `HTTP/1.1 PUT 자체에는 인증 기능`이 없어
- ┣ 누구나 파일을 업로드 가능하다는 `보안 상의 문제`
- ┣ `일반적인 웹 사이트`에서는 `사용되지 않고 있음`
- ┣ 1. `웹 애플리케이션 등에 의한 인증 기능과 짝`을 이루는 경우
- ┣ 2. `REST(Representational State Transfer)`와 같이 `웹끼리`
- ┗ `연계하는 설계 양식`을 사용할 때 이용하는 경우 존재

### HEAD: 메시지 헤더 취득

- `HEAD 메서드` : `GET과 같은 기능`이지만 `메시지 바디는 돌려주지 않음`
- ┗ `URI 유효성`과 `리소스 갱신 시간`을 확인하는 목적으로 사용

### DELETE: 파일 삭제

- `DELETE 메서드` : `파일을 삭제`하기 위해 사용
- ┣ `PUT` 메서드와는 `반대 동작`하며
- ┣ `리퀘스트 URI로 지정된 리소스의 삭제를 요구`
- ┣ HTTP /1.1 DELETE 자체에는 PUT 메서드와 같이 인증 기능이 없음
- ┗ 일반적으로는 사용 x

### OPTIONS: 제공하고 잇는 메소드의 문의

- OPTIONS 메서드는 리퀘스트 URI로 지정한 리소스가 제공하고 있는지 문의

> response

    Allow : GET, POST, HEAD, OPTIONS

### TRACE: 경로 조사

- TRACE 메소드는 Web 서버에 접속해서 자신에게 통신을 되도려 받는
- ┣ `루프백(loop-back)을 발생`
- ┣ 리퀘스트를 보낼 때 : `Max-Forwards`라는 헤더 필드에 수치를 포함시켜
- ┣ 서버를 통과할 때 마다 그 수치를 줄여나감
- ┣ 수치 0이 된 곳을 끝으로
- ┣ `request 마지막으로 수신한 곳` → `상태 코드 200 OK return`
- ┣ 클라이언트 : TRACE 메서드를 사용해서 리퀘스트를 보낸 곳에
- ┗ 어떤 리퀘스트가 가공되어 있는지 등을 조사가능

- 이것은 프록시 등을 중계하여 `오리진(origin) 서버에 접속`할 때
- ┣ 그 동작을 확인하기 위해서 사용
- ┣ 다만 `TRACE 메서드는 거의 사용되지 않고`
- ┣ `크로스 사이트 트페이싱(XST)` 같은 공격을 일으키는 `보안상 문제`
- ┗ 보통은 사용되지 않음

### CONNECT: 프록시에 터널링 요구

- CONNECT 메소드: 프록시에 터널 접속 확립을 요함
- ┣ TCP 통신을 터널링 시키기 위해서 사용
- ┣ 주로 SSL, TLS 등의 프로토콜로 암호화 된 것
- ┗ 터널링 시키기 위해서 사용

> CONNECT 메소드 양식

    CONNECT 프록시 서버 : 포트 HTTP 버전

## 2.6 메소드를 사용해서 지시를 내리다

- `request URI`로 지정한 리소스에 리퀘스트를 보내는 경우
- ┣ `메소드라고 불리는 명령`이 있음
- ┣ `메소드` : `리소스에 어떠한 행동을 하기 원하는지`를
- ┣ 지시하기 위해 존재
- ┗ 메소드에는 `GET`, `POST`, `HEAD`등이 존재

- HTTP/1.0, HTTP/1.1에서 제공하고 있는 메소드에는
- ┣ 다음의 것들이 존재
- ┗ 메소드 : 대/소문자 구별 → 대문자로 작성

| 메소드  | 설명                         | 제공하고 있는 HTTP 버전 |
| ------- | ---------------------------- | ----------------------- |
| GET     | 리소스 취득                  | 1.0, 1.1                |
| POST    | 엔티티 바디 전송             | 1.0, 1.1                |
| PUT     | 파일 전송                    | 1.0, 1.1                |
| HEAD    | 메시지 헤더 취득             | 1.0, 1.1                |
| DELETE  | 파일 삭제                    | 1.0, 1.1                |
| OPTIONS | 서포트하고 잇는 메소드 문의  | 1.1                     |
| TRACE   | 경로 조사                    | 1.1                     |
| CONNECT | 프록시에의 터널링 요구       | 1.1                     |
| LINK    | 리소스 간에 링크 관게를 확립 | 1.0                     |
| UNLINK  | 링크 관계 삭제               | 1.0                     |

> LINK, UNLINK의 경우 1.1에서 제공 X
